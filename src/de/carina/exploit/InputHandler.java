package de.carina.exploit;

import java.io.BufferedReader;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Base64;
import java.util.List;

public class InputHandler {


    private List<String > begriffe = new ArrayList<>();

    public InputHandler() {
        begriffe.add("exit");
        begriffe.add("Password Correct!");

    }

    private String input;
    public void readInput(BufferedReader reader) throws Exception {
        byte[] in = Base64.getDecoder().decode(reader.readLine().getBytes(StandardCharsets.UTF_8));
        input = new String(in);
        Main.mainClass.input = input;
        checkInput(Main.mainClass.input);
        if (!begriffe.contains(input))
        printInput(input);
    }

    public void printInput(String input) {
//TODO: hier soll er den text auf das system schreiben
        if (Main.mainClass.gui.SystemTextArea.getText() == null || Main.mainClass.gui.SystemTextArea.getText().equals(null)) {
            Main.mainClass.gui.SystemTextArea.setText(input);
        } else {
            Main.mainClass.gui.SystemTextArea.setText(Main.mainClass.gui.SystemTextArea.getText() + "\n" + input);
        }
    }

    private void checkInput(String inputString) throws Exception {
        if (inputString.equalsIgnoreCase("Password Correct!")) {
            Main.mainClass.passwdCorrect = true;
        } else if (inputString.equalsIgnoreCase("exit")) {
            Main.mainClass.messanger.disconnect(Main.mainClass.writer, Main.mainClass.socket);
            Main.mainClass.getSocket().close();
            System.exit(0);
        } else if (Main.mainClass.input.equalsIgnoreCase("connected!!")) {
            Main.mainClass.isConnected = true;
        }
    }

}
