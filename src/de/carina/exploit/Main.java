package de.carina.exploit;

import javax.swing.*;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;

import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;
import java.util.HashMap;


public class Main {


    public static Main mainClass = new Main();
    public PrintWriter writer;
    public boolean isConnected = false;
    public BufferedReader reader;
    public String input;
    public Socket socket;
    public Writer writerClass = new Writer();
    public boolean passwdCorrect = false;
    public InputHandler inputHandler = new InputHandler();
    public Messanger messanger = new Messanger();

    public Socket getSocket() {
        return socket;
    }

    public MainGUI MainGUI;
    private JFrame frame;
    public static HashMap<String, Thread> runningThreads = new HashMap<>();
    private static ArrayList<Thread> runningThread = new ArrayList<>();


    public static void main(String[] args) throws Exception {
        mainClass.MainGUI = new MainGUI();

        ServerSocket serverSocket = new ServerSocket(443);
        mainClass.socket = serverSocket.accept();
        mainClass.reader = new BufferedReader(new InputStreamReader(mainClass.socket.getInputStream()));
        mainClass.writer = new PrintWriter(mainClass.getSocket().getOutputStream());


        if (mainClass.socket.isConnected()) {
            mainClass.writerThread.start();
            runningThread.add(mainClass.writerThread);
            runningThreads.put("Writer", runningThread.get(0));
        }

        Main.mainClass.writerClass.write(mainClass.writer, "connected!");


        while (true) {
            mainClass.inputHandler.readInput(mainClass.reader);
        }


    }

    private Thread writerThread = new Thread(new Writer());


    public void createGUI() {
        frame = new JFrame("System Control-Pannel");
        frame.setContentPane(Main.mainClass.MainGUI.SystemPanel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setSize(750, 500);
        frame.setVisible(true);
        frame.setFocusable(true);
    }
}
